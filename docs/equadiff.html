
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Differential equation &#8212; Python for scientists 1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fourier analysis" href="fourier.html" />
    <link rel="prev" title="Data fitting" href="fit.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="fourier.html" title="Fourier analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fit.html" title="Data fitting"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Python for scientists 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index_numpy.html" accesskey="U">Numerical calculation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="differential-equation">
<h1>Differential equation<a class="headerlink" href="#differential-equation" title="Permalink to this headline">Â¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy</span></code> library contains a large number of scientific modules. This is almost a standard library in the sense that it contains all standard numerical algorithms. The full documentation can be found at <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/">http://docs.scipy.org/doc/scipy/reference/</a>.</p>
<p>The module that contains the functions for solving differential equation is the <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code> module with the <code class="xref py py-func docutils literal notranslate"><span class="pre">odeint()</span></code> et <code class="xref py py-func docutils literal notranslate"><span class="pre">ode()</span></code> functions. We will present only the <code class="xref py py-func docutils literal notranslate"><span class="pre">ode()</span></code> function which is more complete. Those functions can solve ordinary differential equation :</p>
<div class="math">
<p><img src="_images/math/9ccf61372caab644f83fba9d663e9e23b7973bba.png" alt="\frac{dy}{dt} = f(t,y)"/></p>
</div><p>where <code class="docutils literal notranslate"><span class="pre">y</span></code> is a numpy array.</p>
<p>Let us look to the following example <img class="math" src="_images/math/cfc1658917d986f2bce418e8db21ff38f2fa4344.png" alt="y^\prime = -y"/> with <img class="math" src="_images/math/0b343752b199439f5b7fcaee390cf11cffe22947.png" alt="y(0)=1"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">ode</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">y</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;vode&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
<p>Few remarks :</p>
<ul class="simple">
<li>Many solvers can be used (see the online documentation). Each solver is indeed a Fortran library that was adapted for scipy. Each solver has its own parameters. The most common parameters are the absolute (atol) and relative precision (rtol). Compared to well known imperative solvers (like the Euler or Runge-Kutta methods), the scipy solvers are able to adapt the size of the steps in order to obtain the required precision.</li>
<li>For highest order differential equation, the trick consists in writting a first order equation by adding intermediate functions which are the derivative of the initial functions.</li>
</ul>
<p>For example : solution of the linearized pendulum equation: <img class="math" src="_images/math/93fd5fb37c0a70e334f74158e642e56fc7abd0ff.png" alt="y^{\prime\prime} = -y"/>, with initial conditions <img class="math" src="_images/math/0b343752b199439f5b7fcaee390cf11cffe22947.png" alt="y(0)=1"/> and <img class="math" src="_images/math/39e9ffd59bb1835e2234e0805280465a9de346ca.png" alt="y^\prime(0)=0"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">ode</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">yprime</span><span class="o">=</span><span class="n">Y</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">yprime</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;vode&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="fit.html"
                        title="previous chapter">Data fitting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fourier.html"
                        title="next chapter">Fourier analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/equadiff.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="fourier.html" title="Fourier analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="fit.html" title="Data fitting"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Python for scientists 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index_numpy.html" >Numerical calculation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Pierre CladÃ©.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>